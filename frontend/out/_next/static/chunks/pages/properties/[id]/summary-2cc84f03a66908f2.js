(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2114],{4885:function(e,t,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/properties/[id]/summary",function(){return o(3336)}])},7443:function(e,t,o){"use strict";var r=o(3454);o(1479);var s=o(7294),n=s&&"object"==typeof s&&"default"in s?s:{default:s},a=void 0!==r&&r.env&&!0,i=function(e){return"[object String]"===Object.prototype.toString.call(e)},l=function(){function e(e){var t=void 0===e?{}:e,o=t.name,r=void 0===o?"stylesheet":o,s=t.optimizeForSpeed,n=void 0===s?a:s;c(i(r),"`name` must be a string"),this._name=r,this._deletedRulePlaceholder="#"+r+"-deleted-rule____{}",c("boolean"==typeof n,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=n,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var l=document.querySelector('meta[property="csp-nonce"]');this._nonce=l?l.getAttribute("content"):null}var t=e.prototype;return t.setOptimizeForSpeed=function(e){c("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),c(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},t.isOptimizeForSpeed=function(){return this._optimizeForSpeed},t.inject=function(){var e=this;if(c(!this._injected,"sheet already injected"),this._injected=!0,this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(a||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(t,o){return"number"==typeof o?e._serverSheet.cssRules[o]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),o},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},t.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},t.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},t.insertRule=function(e,t){if(c(i(e),"`insertRule` accepts only strings"),this._optimizeForSpeed){var o=this.getSheet();"number"!=typeof t&&(t=o.cssRules.length);try{o.insertRule(e,t)}catch(t){return a||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var r=this._tags[t];this._tags.push(this.makeStyleTag(this._name,e,r))}return this._rulesCount++},t.replaceRule=function(e,t){if(this._optimizeForSpeed){var o=this.getSheet();if(t.trim()||(t=this._deletedRulePlaceholder),!o.cssRules[e])return e;o.deleteRule(e);try{o.insertRule(t,e)}catch(r){a||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),o.insertRule(this._deletedRulePlaceholder,e)}}else{var r=this._tags[e];c(r,"old rule at index `"+e+"` not found"),r.textContent=t}return e},t.deleteRule=function(e){if(this._optimizeForSpeed)this.replaceRule(e,"");else{var t=this._tags[e];c(t,"rule at index `"+e+"` not found"),t.parentNode.removeChild(t),this._tags[e]=null}},t.flush=function(){this._injected=!1,this._rulesCount=0,this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]},t.cssRules=function(){var e=this;return this._tags.reduce(function(t,o){return o?t=t.concat(Array.prototype.map.call(e.getSheetForTag(o).cssRules,function(t){return t.cssText===e._deletedRulePlaceholder?null:t})):t.push(null),t},[])},t.makeStyleTag=function(e,t,o){t&&c(i(t),"makeStyleTag accepts only strings as second parameter");var r=document.createElement("style");this._nonce&&r.setAttribute("nonce",this._nonce),r.type="text/css",r.setAttribute("data-"+e,""),t&&r.appendChild(document.createTextNode(t));var s=document.head||document.getElementsByTagName("head")[0];return o?s.insertBefore(r,o):s.appendChild(r),r},function(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,[{key:"length",get:function(){return this._rulesCount}}]),e}();function c(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var d=function(e){for(var t=5381,o=e.length;o;)t=33*t^e.charCodeAt(--o);return t>>>0},u={};function h(e,t){if(!t)return"jsx-"+e;var o=String(t),r=e+o;return u[r]||(u[r]="jsx-"+d(e+"-"+o)),u[r]}function m(e,t){var o=e+t;return u[o]||(u[o]=t.replace(/__jsx-style-dynamic-selector/g,e)),u[o]}var p=function(){function e(e){var t=void 0===e?{}:e,o=t.styleSheet,r=void 0===o?null:o,s=t.optimizeForSpeed,n=void 0!==s&&s;this._sheet=r||new l({name:"styled-jsx",optimizeForSpeed:n}),this._sheet.inject(),r&&"boolean"==typeof n&&(this._sheet.setOptimizeForSpeed(n),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var t=e.prototype;return t.add=function(e){var t=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer||(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,t){return e[t]=0,e},{}));var o=this.getIdAndRules(e),r=o.styleId,s=o.rules;if(r in this._instancesCounts){this._instancesCounts[r]+=1;return}var n=s.map(function(e){return t._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[r]=n,this._instancesCounts[r]=1},t.remove=function(e){var t=this,o=this.getIdAndRules(e).styleId;if(function(e,t){if(!e)throw Error("StyleSheetRegistry: "+t+".")}(o in this._instancesCounts,"styleId: `"+o+"` not found"),this._instancesCounts[o]-=1,this._instancesCounts[o]<1){var r=this._fromServer&&this._fromServer[o];r?(r.parentNode.removeChild(r),delete this._fromServer[o]):(this._indices[o].forEach(function(e){return t._sheet.deleteRule(e)}),delete this._indices[o]),delete this._instancesCounts[o]}},t.update=function(e,t){this.add(t),this.remove(e)},t.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},t.cssRules=function(){var e=this,t=this._fromServer?Object.keys(this._fromServer).map(function(t){return[t,e._fromServer[t]]}):[],o=this._sheet.cssRules();return t.concat(Object.keys(this._indices).map(function(t){return[t,e._indices[t].map(function(e){return o[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},t.styles=function(e){var t,o;return t=this.cssRules(),void 0===(o=e)&&(o={}),t.map(function(e){var t=e[0],r=e[1];return n.default.createElement("style",{id:"__"+t,key:"__"+t,nonce:o.nonce?o.nonce:void 0,dangerouslySetInnerHTML:{__html:r}})})},t.getIdAndRules=function(e){var t=e.children,o=e.dynamic,r=e.id;if(o){var s=h(r,o);return{styleId:s,rules:Array.isArray(t)?t.map(function(e){return m(s,e)}):[m(s,t)]}}return{styleId:h(r),rules:Array.isArray(t)?t:[t]}},t.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,t){return e[t.id.slice(2)]=t,e},{})},e}(),f=s.createContext(null);f.displayName="StyleSheetContext";var g=n.default.useInsertionEffect||n.default.useLayoutEffect,_=new p;function y(e){var t=_||s.useContext(f);return t&&g(function(){return t.add(e),function(){t.remove(e)}},[e.id,String(e.dynamic)]),null}y.dynamic=function(e){return e.map(function(e){return h(e[0],e[1])}).join(" ")},t.style=y},645:function(e,t,o){"use strict";e.exports=o(7443).style},3336:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return _}});var r=o(5893),s=o(645),n=o.n(s),a=o(7294),i=o(1163),l=o(2920),c=o(9008),d=o.n(c),u=o(1664),h=o.n(u),m=o(1491),p=o(610);let f=()=>(0,r.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M15 19.9201L8.47997 13.4001C7.70997 12.6301 7.70997 11.3701 8.47997 10.6001L15 4.08008",stroke:"#292D32",strokeWidth:"1.5",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"})}),g=()=>(0,r.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M7.42505 16.6L12.8584 11.1667C13.5 10.525 13.5 9.47502 12.8584 8.83336L7.42505 3.40002",stroke:"#292D32",strokeWidth:"1.5",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"})});function _(){let{user:e,loading:t}=(0,m.a)(),s=(0,i.useRouter)(),{id:c,from:u}=s.query,[_,y]=(0,a.useState)(!1),[x,v]=(0,a.useState)(null),[b,S]=(0,a.useState)(!1),[j,w]=(0,a.useState)({address:"Not specified",lease_duration:null,lease_duration_type:"months",deposit_amount:null,contract_start_date:null,contract_end_date:null,move_in_date:null,moveout_date:null,landlord_email:null,landlord_phone:null}),[N,C]=(0,a.useState)(null),[A,I]=(0,a.useState)(null),[k,F]=(0,a.useState)([]),[E,R]=(0,a.useState)({});(0,a.useEffect)(()=>{t||e||s.push("/welcome")},[e,t,s]),(0,a.useEffect)(()=>{c&&(async()=>{try{"walkthrough"===u&&S(!0);let t=null;try{t=(await p.E.properties.getById(c)).data,console.log("Property API response (success):",t)}catch(e){console.error("Error fetching property data from API:",e);try{console.log("Trying alternative API call for property data");let e=(await o.e(9204).then(o.bind(o,9204))).default,r=localStorage.getItem("token"),s="localhost"!==window.location.hostname;t=(await e.get("".concat(s?"https://api.tenantli.ai":"http://localhost:5050","/api/properties/").concat(c),{headers:r?{Authorization:"Bearer ".concat(r)}:{}})).data,console.log("Property API response (alternative):",t)}catch(t){throw console.error("Alternative API call also failed:",t),e}}if(!t){console.error("Failed to load property data"),l.Am.error("Failed to load property information");return}console.log("Property fields:",{address:t.address,description:t.description,lease_duration:t.lease_duration,lease_duration_type:t.lease_duration_type,deposit_amount:t.deposit_amount,contract_start_date:t.contract_start_date,contract_end_date:t.contract_end_date,move_in_date:t.move_in_date,landlord_email:t.landlord_email,landlord_phone:t.landlord_phone});let r={...t,contract_start_date:t.contract_start_date?new Date(t.contract_start_date).toISOString().split("T")[0]:null,contract_end_date:t.contract_end_date?new Date(t.contract_end_date).toISOString().split("T")[0]:null,move_in_date:t.move_in_date?new Date(t.move_in_date).toISOString().split("T")[0]:null};v(r);let s="property_".concat(c,"_addunit"),n=null;try{let e=localStorage.getItem(s);e&&(n=JSON.parse(e),console.log("Found stored addunit data:",n))}catch(e){console.error("Error reading from localStorage:",e)}let a={address:t.address||"Not specified",lease_duration:t.lease_duration||null,lease_duration_type:t.lease_duration_type||"months",deposit_amount:t.deposit_amount||null,contract_start_date:t.contract_start_date||null,contract_end_date:t.contract_end_date||null,move_in_date:t.move_in_date||null,landlord_email:t.landlord_email||null,landlord_phone:t.landlord_phone||null};if(n&&(!a.lease_duration&&n.leaseDuration&&(a.lease_duration=n.leaseDuration,console.log("Using stored lease duration:",a.lease_duration)),!a.lease_duration_type&&n.leaseDurationType&&(a.lease_duration_type=n.leaseDurationType,console.log("Using stored lease duration type:",a.lease_duration_type)),!a.deposit_amount&&n.depositAmount&&(a.deposit_amount=n.depositAmount,console.log("Using stored deposit amount:",a.deposit_amount)),!a.contract_start_date&&n.contractStartDate&&(a.contract_start_date=n.contractStartDate,console.log("Using stored contract start date:",a.contract_start_date)),!a.contract_end_date&&n.calculatedEndDate&&(a.contract_end_date=n.calculatedEndDate,console.log("Using stored contract end date:",a.contract_end_date)),!a.move_in_date&&n.moveInDate&&(a.move_in_date=n.moveInDate,console.log("Using stored move in date:",a.move_in_date))),console.log("Initial property details (before address handling):",a),("Not specified"===a.address||!a.address)&&t.description&&(a.address=t.description,console.log("Using description as address:",a.address)),n&&n.address&&(!a.address||"Not specified"===a.address||a.address===t.address)&&(a.address=n.address,console.log("Using stored address from addunit:",a.address)),!a.contract_end_date&&(a.contract_start_date||a.move_in_date)&&a.lease_duration){let e=a.contract_start_date||a.move_in_date;console.log("Calculating move-out date from: start=".concat(e,", duration=").concat(a.lease_duration,", type=").concat(a.lease_duration_type));let t=z(e,a.lease_duration,a.lease_duration_type);t&&(a.contract_end_date=t.toISOString().split("T")[0],console.log("Calculated move-out date: ".concat(a.contract_end_date)))}w(a),console.log("Processed property details:",a);let i="property_".concat(c),d=localStorage.getItem("".concat(i,"_user")),h=localStorage.getItem("".concat(i,"_landlord"));if(console.log("Local storage - user details:",d),console.log("Local storage - landlord details:",h),t.landlord_email||t.landlord_phone){let e={email:t.landlord_email||"",phone:t.landlord_phone||""};console.log("Using landlord details from API:",e),I(e)}else if(h)try{let e=JSON.parse(h);console.log("Parsed landlord data from localStorage:",e),I(e)}catch(e){console.error("Error parsing landlord details:",e),I({email:"",phone:""})}else I({email:"",phone:""});if(d)try{let e=JSON.parse(d);console.log("Parsed user data:",e),C(e)}catch(t){console.error("Error parsing user details:",t),C({name:(null==e?void 0:e.name)||"",email:(null==e?void 0:e.email)||"",phone:""})}else C({name:(null==e?void 0:e.name)||"",email:(null==e?void 0:e.email)||"",phone:""});try{console.log("Attempting to load photos for property from API");try{let e=await p.E.photos.getByProperty(c);if(e.data){console.log("Property photos loaded from API:",e.data);let t={};Array.isArray(e.data)?(e.data.forEach(e=>{if(e.room_id){t[e.room_id]||(t[e.room_id]={photos:[]});let o=e.url&&e.url.startsWith("/")?"".concat(p.E.getBaseUrl()).concat(e.url):e.url;t[e.room_id].photos.push({...e,url:o})}}),console.log("Processed photos by room (format 1):",t)):e.data.photosByRoom&&(Object.keys(e.data.photosByRoom).forEach(o=>{let r=e.data.photosByRoom[o];t[o]={photos:Array.isArray(r.photos)?r.photos.map(e=>({...e,url:e.url&&e.url.startsWith("/")?"".concat(p.E.getBaseUrl()).concat(e.url):e.url})):[]}}),console.log("Processed photos by room (format 2):",t)),R(t)}}catch(e){console.error("Error loading photos from API:",e)}}catch(e){console.error("Error in photos loading process:",e)}let m=localStorage.getItem("property_".concat(c,"_rooms"));console.log("Local storage - rooms:",m);let f=[];if(m)try{let e=JSON.parse(m);console.log("Parsed rooms from localStorage:",e),f=e}catch(e){console.error("Error parsing rooms from localStorage:",e)}try{console.log("Attempting to load rooms from database API");let e=await p.E.properties.getRooms(c);if(e.data&&e.data.length>0){if(console.log("Rooms loaded from database API:",e.data),f.length>0){let t={};e.data.forEach(e=>{let o=e.roomId||e.id;o&&(t[o]=e)});let o={};f.forEach(e=>{let t=e.roomId||e.id;t&&(o[t]=e)});let r=[];[...new Set([...Object.keys(t),...Object.keys(o)])].forEach(e=>{let s=t[e],n=o[e];if(s&&n){let e=s.timestamp||s.lastUpdated||"";(n.timestamp||n.lastUpdated||"")>e?r.push(n):r.push(s)}else s?r.push(s):n&&r.push(n)}),console.log("Using merged rooms from both sources:",r),F(r),localStorage.setItem("property_".concat(c,"_rooms"),JSON.stringify(r));try{console.log("Syncing merged rooms back to database"),await p.E.properties.saveRooms(c,r)}catch(e){console.error("Error syncing merged rooms to database:",e)}}else console.log("Using rooms from database API (no localStorage rooms)"),F(e.data),localStorage.setItem("property_".concat(c,"_rooms"),JSON.stringify(e.data))}else console.log("No rooms found in database API, using localStorage rooms"),F(f)}catch(e){console.log("Error loading rooms from database API:",e),console.log("Falling back to localStorage rooms"),F(f)}let g="property_".concat(c,"_room_photos"),_=localStorage.getItem(g);if(console.log("Local storage - room photos:",_?"Found":"Not found"),_)try{let e=JSON.parse(_);console.log("Parsed room photos:",e),R(e)}catch(e){console.error("Error parsing room photos:",e)}else{console.log("Attempting to load individual room photos");let e={};if(m){for(let t of JSON.parse(m)){let o=t.id,r="property_".concat(c,"_room_").concat(o,"_photos"),s=localStorage.getItem(r);if(s)try{e[o]={photos:JSON.parse(s)}}catch(e){console.error("Error parsing photos for room ".concat(o,":"),e)}}Object.keys(e).length>0&&(console.log("Combined room photos:",e),R(e))}}}catch(e){console.error("Error loading property data:",e),l.Am.error("Failed to load property details")}})()},[c,e,u]);let P=async()=>{y(!0);try{let t=await p.E.reports.getByProperty(c),o=t.data?t.data.filter(e=>"move-in"===e.type):[];if(0===o.length){console.log("Creating new move-in report for property:",j.address);let t={property_id:c,title:"Move-in Walkthrough for ".concat(j.address),description:"Automatically generated move-in walkthrough report",type:"move-in",address:j.address,tenant_name:(null==N?void 0:N.name)||(null==e?void 0:e.name)||"",tenant_email:(null==N?void 0:N.email)||(null==e?void 0:e.email)||"",tenant_phone:(null==N?void 0:N.phone)||"",landlord_name:"Property Owner",landlord_email:(null==A?void 0:A.email)||j.landlord_email||"",landlord_phone:(null==A?void 0:A.phone)||j.landlord_phone||"",rooms:k.map(e=>({id:e.id||e.roomId,name:e.name||e.roomName,type:e.type||e.roomType,notes:e.roomIssueNotes||e.issueNotes||[]}))},o=await p.E.reports.create(t),r=o.data.id,n=o.data.uuid;if(Object.keys(E).length>0)for(let e in console.log("Associating photos with the report"),E){let t=k.find(t=>t.id===e||t.roomId===e);if(t&&E[e]){let o=[];for(let s of(Array.isArray(E[e])?o=E[e]:E[e].photos&&Array.isArray(E[e].photos)&&(o=E[e].photos),o))if(s&&s.id)try{await p.E.photos.associateWithReport(s.id,r,{roomId:e,roomName:t.name||t.roomName})}catch(e){console.error("Error associating photo ".concat(s.id," with report:"),e)}}}if((null==A?void 0:A.email)||j.landlord_email){let e=(null==A?void 0:A.email)||j.landlord_email;console.log("Sending email notification to landlord:",e);let t={recipientEmail:e,recipientName:"Property Owner",subject:"New Move-in Walkthrough Report Shared",message:"A new move-in walkthrough report has been shared with you for property at ".concat(j.address,". You can view the report by clicking the button below."),status:"custom",reportId:r,reportUuid:n};await p.E.reports.sendNotification(r,t)}else console.log("No landlord email found to send notification");localStorage.setItem("lastSharedPropertyId",c),n&&localStorage.setItem("report_uuid",n),s.push("/reports/share-success")}else{let e=o[0];if(console.log("Using existing move-in report:",e.id),(null==A?void 0:A.email)||j.landlord_email){let t=(null==A?void 0:A.email)||j.landlord_email;console.log("Sending email notification to landlord:",t);let o={recipientEmail:t,recipientName:"Property Owner",subject:"Move-in Walkthrough Report Shared",message:"A move-in walkthrough report has been shared with you for property at ".concat(j.address,". You can view the report by clicking the button below."),status:"custom",reportId:e.id,reportUuid:e.uuid};await p.E.reports.sendNotification(e.id,o)}else console.log("No landlord email found to send notification");localStorage.setItem("lastSharedPropertyId",c),e.uuid&&localStorage.setItem("report_uuid",e.uuid),s.push("/reports/share-success")}}catch(e){console.error("Error sharing walkthrough:",e),console.error("Failed to share walkthrough. Please try again."),y(!1)}},D=e=>{console.log("Checking photos for room",e,"in",E);let t=k.find(t=>t.id===e||t.roomId===e);if(t&&t.photoCount)return console.log("Found photoCount ".concat(t.photoCount," directly in room object for ").concat(e)),t.photoCount;if(E[e]){if(Array.isArray(E[e]))return console.log("Found ".concat(E[e].length," photos for ").concat(e," in roomPhotos array")),E[e].length;if(E[e].photos&&Array.isArray(E[e].photos))return console.log("Found ".concat(E[e].photos.length," photos for ").concat(e," in roomPhotos.photos array")),E[e].photos.length;if(E[e].photoCount)return console.log("Found photoCount ".concat(E[e].photoCount," in roomPhotos object for ").concat(e)),E[e].photoCount}try{let t="property_".concat(c,"_room_").concat(e,"_photos"),o=localStorage.getItem(t);if(o){let t=JSON.parse(o);return console.log("Found ".concat(Array.isArray(t)?t.length:0," photos for ").concat(e," directly in localStorage")),Array.isArray(t)?t.length:0}}catch(t){console.error("Error getting photo count for room ".concat(e,":"),t)}return 0},O=e=>{try{if(e.notes&&Array.isArray(e.notes))return e.notes.length;if(e.roomIssueNotes){if("string"==typeof e.roomIssueNotes)return e.roomIssueNotes.split(",").filter(e=>e.trim().length>0).length;if(Array.isArray(e.roomIssueNotes))return e.roomIssueNotes.length;if("number"==typeof e.roomIssueNotes)return e.roomIssueNotes}else if(e.issueNotes){if("string"==typeof e.issueNotes)return e.issueNotes.split(",").filter(e=>e.trim().length>0).length;if(Array.isArray(e.issueNotes))return e.issueNotes.length;if("number"==typeof e.issueNotes)return e.issueNotes}else if(void 0!==e.noteCount)return e.noteCount}catch(t){console.error("Error calculating note count:",t,e)}return 0},z=(e,t,o)=>{if(!e||!t)return null;try{let r=new Date(e);if(isNaN(r.getTime()))return console.error("Invalid start date for calculation:",e),null;let s=parseInt(t,10);if(isNaN(s)||s<=0)return console.error("Invalid lease duration:",t),null;return"days"===o?r.setDate(r.getDate()+s):"weeks"===o?r.setDate(r.getDate()+7*s):"years"===o?r.setFullYear(r.getFullYear()+s):r.setMonth(r.getMonth()+s),r}catch(e){return console.error("Error calculating move-out date:",e),null}};return x&&c?(0,r.jsxs)("div",{className:"relative flex flex-col w-full min-h-screen bg-[#FBF5DA] font-['Nunito']",children:[(0,r.jsxs)(d(),{children:[(0,r.jsx)("title",{className:"jsx-dc0855997fdc34e4",children:"Property Summary - tenantli"}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover",className:"jsx-dc0855997fdc34e4"}),(0,r.jsx)("meta",{name:"theme-color",content:"#FBF5DA",className:"jsx-dc0855997fdc34e4"}),(0,r.jsx)("meta",{name:"apple-mobile-web-app-capable",content:"yes",className:"jsx-dc0855997fdc34e4"}),(0,r.jsx)("meta",{name:"apple-mobile-web-app-status-bar-style",content:"default",className:"jsx-dc0855997fdc34e4"}),(0,r.jsx)("meta",{name:"mobile-web-app-capable",content:"yes",className:"jsx-dc0855997fdc34e4"}),(0,r.jsx)("meta",{name:"apple-touch-fullscreen",content:"yes",className:"jsx-dc0855997fdc34e4"}),(0,r.jsx)("link",{rel:"manifest",href:"/manifest.json",className:"jsx-dc0855997fdc34e4"}),(0,r.jsx)("link",{rel:"apple-touch-icon",href:"/icons/icon-192x192.png",className:"jsx-dc0855997fdc34e4"}),(0,r.jsx)("meta",{name:"format-detection",content:"telephone=no",className:"jsx-dc0855997fdc34e4"}),(0,r.jsx)("meta",{httpEquiv:"ScreenOrientation",content:"autoRotate:disabled",className:"jsx-dc0855997fdc34e4"}),(0,r.jsx)("meta",{name:"full-screen",content:"yes",className:"jsx-dc0855997fdc34e4"}),(0,r.jsx)("meta",{name:"browsermode",content:"application",className:"jsx-dc0855997fdc34e4"}),(0,r.jsx)("meta",{name:"screen-orientation",content:"portrait",className:"jsx-dc0855997fdc34e4"}),(0,r.jsx)(n(),{id:"dc0855997fdc34e4",children:'body{background-color:#FBF5DA;overflow-x:hidden;position:fixed;width:100%;height:100%;margin:0;padding:0;font-family:"Nunito",sans-serif}#__next{height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.safe-area-top{padding-top:env(safe-area-inset-top,40px)}.safe-area-bottom{padding-bottom:env(safe-area-inset-bottom,20px)}@supports(padding:max(0px)){.safe-area-top{padding-top:max(env(safe-area-inset-top),40px)}.safe-area-bottom{padding-bottom:max(env(safe-area-inset-bottom),20px)}}@media screen and (-webkit-min-device-pixel-ratio:0){select,textarea,input{font-size:16px!important}}button,a{-webkit-tap-highlight-color:transparent;touch-action:manipulation;-ms-touch-action:manipulation}:focus-visible{outline:2px solid#1C2C40;outline-offset:2px}*{-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;-webkit-text-size-adjust:100%}html{position:fixed;height:100%;overflow:hidden}body{position:fixed;height:100%;overflow:hidden}'})]}),(0,r.jsxs)("div",{className:"fixed top-0 left-0 right-0 z-50",children:[(0,r.jsx)("div",{className:"h-[40px] safe-area-top bg-[#FBF5DA]"}),(0,r.jsx)("div",{className:"h-[65px] bg-[#FBF5DA] shadow-sm",children:(0,r.jsxs)("div",{className:"flex items-center justify-center relative h-full px-4",children:[(0,r.jsx)(h(),{href:"/",className:"absolute left-4 p-2 hover:bg-black/5 rounded-lg transition-colors duration-200","aria-label":"Go back",children:(0,r.jsx)(f,{})}),(0,r.jsx)("h1",{className:"text-[18px] font-semibold text-[#0B1420]",children:"Property Summary"})]})})]}),(0,r.jsx)("div",{className:"flex flex-col min-h-screen pt-[105px] pb-[100px]",children:(0,r.jsx)("div",{className:"flex-1 px-4 py-5",children:(0,r.jsx)("div",{className:"max-w-[400px] mx-auto sm:max-w-2xl",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-[#D1E7D5] overflow-hidden",children:[(0,r.jsxs)("div",{className:"divide-y divide-[#ECF0F5]",children:[(0,r.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between hover:bg-gray-50 transition-colors duration-200",children:[(0,r.jsx)("span",{className:"text-sm text-[#0B1420]",children:"Tenant"}),(0,r.jsx)("span",{className:"text-sm font-bold text-[#1C2C40]",children:(null==N?void 0:N.name)||(null==e?void 0:e.name)||""})]}),(0,r.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between hover:bg-gray-50 transition-colors duration-200",children:[(0,r.jsx)("span",{className:"text-sm text-[#0B1420] min-w-[100px]",children:"Address"}),(0,r.jsx)("span",{className:"text-sm font-bold text-[#1C2C40] text-right flex-1 ml-4",children:j.address&&"Not specified"!==j.address?j.address:"Not specified"})]}),(0,r.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between hover:bg-gray-50 transition-colors duration-200",children:[(0,r.jsx)("span",{className:"text-sm text-[#0B1420] min-w-[100px]",children:"Lease Duration"}),(0,r.jsx)("span",{className:"text-sm font-bold text-[#1C2C40] text-right flex-1 ml-4",children:j.lease_duration&&"null"!==j.lease_duration?"".concat(j.lease_duration," ").concat(j.lease_duration_type||"months"):"Not specified"})]}),(0,r.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between hover:bg-gray-50 transition-colors duration-200",children:[(0,r.jsx)("span",{className:"text-sm text-[#0B1420] min-w-[100px]",children:"Move out Date"}),(0,r.jsx)("span",{className:"text-sm font-bold text-[#1C2C40] text-right flex-1 ml-4",children:(e=>{if(!e)return"Not specified";try{let t=new Date(e);if(isNaN(t.getTime()))return console.error("Invalid date:",e),"Not specified";return t.toLocaleDateString("en-US",{day:"2-digit",month:"2-digit",year:"numeric"}).replace(/\//g,".")}catch(e){return console.error("Error formatting date:",e),"Not specified"}})(j.contract_end_date)})]}),(0,r.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between hover:bg-gray-50 transition-colors duration-200",children:[(0,r.jsx)("span",{className:"text-sm text-[#0B1420] min-w-[100px]",children:"Deposit Amount"}),(0,r.jsx)("span",{className:"text-sm font-bold text-[#1C2C40] text-right flex-1 ml-4",children:j.deposit_amount&&"null"!==j.deposit_amount?(e=>{if(!e&&0!==e)return"Not specified";try{let t=parseFloat(e);if(isNaN(t))return console.error("Invalid currency amount:",e),"Not specified";return"$".concat(t.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,","))}catch(e){return console.error("Error formatting currency:",e),"Not specified"}})(j.deposit_amount):"Not specified"})]}),(0,r.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between hover:bg-gray-50 transition-colors duration-200",children:[(0,r.jsx)("span",{className:"text-sm text-[#0B1420]",children:"Landlord Mail"}),(0,r.jsx)("span",{className:"text-sm font-bold text-[#1C2C40] truncate ml-4",children:j.landlord_email||(null==A?void 0:A.email)||"Not provided"})]}),(0,r.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between hover:bg-gray-50 transition-colors duration-200",children:[(0,r.jsx)("span",{className:"text-sm text-[#0B1420]",children:"Landlord Phone"}),(0,r.jsx)("span",{className:"text-sm font-bold text-[#1C2C40]",children:j.landlord_phone||(null==A?void 0:A.phone)||"Not provided"})]})]}),k.length>0&&(0,r.jsx)("div",{className:"mt-4 mb-2 px-4",children:(0,r.jsx)("h2",{className:"text-base font-semibold text-[#0B1420] mb-3",children:"Rooms"})}),k.length>0&&k.map((e,t)=>{let o=e.roomId||e.id,n=e.roomName||e.name||e.type||e.roomType||"Room ".concat(t+1),a=e.roomType||e.type||"other",i=e.isCompleted;return console.log("[Summary] Room: ".concat(n,", isCompleted: ").concat(i,", photoCount: ").concat(D(o),", roomQuality: ").concat(e.roomQuality,", notes: ").concat(O(e))),(0,r.jsxs)("div",{className:"px-4 py-3 flex items-start justify-between cursor-pointer hover:bg-gray-50 transition-colors duration-200 border-t border-[#ECF0F5] first:border-t-0",onClick:()=>{s.push({pathname:"/move-out/room",query:{propertyId:c,roomId:o,roomName:n,roomType:a,returnUrl:"/properties/".concat(c,"/summary").concat(b?"?from=walkthrough":""),isReport:b?"true":"false"}})},children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[i&&(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("circle",{cx:"8",cy:"8",r:"8",fill:"#1C2C40"}),(0,r.jsx)("path",{d:"M6.66667 8.66667L7.33333 9.33333L9.33333 7.33333",stroke:"white",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),(0,r.jsx)("span",{className:"text-sm font-semibold text-[#0B1420]",children:n}),O(e)>0&&(0,r.jsxs)("span",{className:"text-xs text-[#515964]",children:["(",O(e)," ",1===O(e)?"item":"items"," noted)"]}),0===O(e)&&(0,r.jsx)("span",{className:"text-xs text-[#515964]",children:"(No Notes)"})]}),D(o)>0&&(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,r.jsx)("div",{className:"relative h-6 z-10",children:(0,r.jsx)("div",{className:"flex -space-x-2",children:[...Array(Math.min(4,D(o)||0))].map((e,t)=>{let s=null;try{var n,a,i,l,d;if(null===(i=E[o])||void 0===i?void 0:null===(a=i.photos)||void 0===a?void 0:null===(n=a[t])||void 0===n?void 0:n.url){if((s=E[o].photos[t].url)&&s.startsWith("/")){let e="localhost"!==window.location.hostname;s="".concat(e?"https://api.tenantli.ai":"http://localhost:5050").concat(s),console.log("Generated full URL for room photo: ".concat(s))}}else if(null===(d=E[o])||void 0===d?void 0:null===(l=d.photos)||void 0===l?void 0:l[t]){if(s=E[o].photos[t],"string"==typeof s&&s.startsWith("/")){let e="localhost"!==window.location.hostname;s="".concat(e?"https://api.tenantli.ai":"http://localhost:5050").concat(s),console.log("Generated full URL for room photo: ".concat(s))}}else{let e="property_".concat(c,"_room_").concat(o,"_photos"),r=localStorage.getItem(e);if(r)try{let e=JSON.parse(r);if(e&&e.length>t){let o=e[t];if((s="string"==typeof o?o:(null==o?void 0:o.url)||null)&&"string"==typeof s&&s.startsWith("/")){let e="localhost"!==window.location.hostname;s="".concat(e?"https://api.tenantli.ai":"http://localhost:5050").concat(s),console.log("Generated full URL for room photo from localStorage: ".concat(s))}}}catch(e){console.error("Error parsing photo data for room ".concat(o,":"),e)}}}catch(e){console.error("Error getting photo URL for room ".concat(o,":"),e)}return console.log("Photo URL for room ".concat(o,", index ").concat(t,": ").concat(s||"None")),(0,r.jsxs)("div",{className:"relative w-6 h-6 bg-gray-200 border-2 border-white rounded-full overflow-hidden shadow-sm",style:{backgroundImage:s?"url(".concat(s,")"):"none",backgroundSize:"cover",backgroundPosition:"center",zIndex:10-t},children:[!s&&(0,r.jsx)("div",{className:"flex items-center justify-center w-full h-full bg-gray-200",children:(0,r.jsxs)("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("path",{d:"M6 8C7.10457 8 8 7.10457 8 6C8 4.89543 7.10457 4 6 4C4.89543 4 4 4.89543 4 6C4 7.10457 4.89543 8 6 8Z",fill:"#A3ADB8"}),(0,r.jsx)("path",{d:"M9.33333 2H6.66667C3.33333 2 2 3.33333 2 6.66667V9.33333C2 12.6667 3.33333 14 6.66667 14H9.33333C12.6667 14 14 12.6667 14 9.33333V6.66667C14 3.33333 12.6667 2 9.33333 2ZM12.3067 9.63333L10.2867 7.22C10.08 6.96667 9.82667 6.96667 9.62 7.22L7.88667 9.3C7.68667 9.55 7.43333 9.55 7.23333 9.3L6.65333 8.58C6.45333 8.33667 6.20667 8.34333 6.01333 8.59333L3.81333 11.4767C3.57333 11.7933 3.69333 12.06 4.10667 12.06H11.8867C12.3 12.06 12.4267 11.7933 12.3067 9.63333Z",fill:"#A3ADB8"})]})}),D(o)>4&&3===t&&(0,r.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center bg-[#1C2C40] text-white text-[10px] font-bold",children:["+",D(o)-3]})]},t)})})}),(0,r.jsxs)("span",{className:"text-xs text-[#515964]",children:["(",D(o)," ",1===D(o)?"Photo":"Photos",")"]})]})]}),(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)(g,{})})]},o)})]})})})}),(0,r.jsx)("div",{className:"fixed bottom-0 left-0 right-0 px-5 py-4 bg-[#FBF5DA] shadow-inner safe-area-bottom z-50",children:(0,r.jsx)("div",{className:"max-w-[400px] mx-auto sm:max-w-2xl",children:(0,r.jsx)("form",{onSubmit:e=>{e.preventDefault(),b||P()},children:(0,r.jsx)("button",{type:"submit",disabled:_||b,className:"w-full h-14 bg-[#1C2C40] text-white font-semibold rounded-2xl shadow-sm hover:bg-[#283c56] disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 touch-manipulation focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#1C2C40]","aria-label":b?"Walkthrough already shared":_?"Sharing walkthrough...":"Share walkthrough",children:b?"Walkthrough Already Shared":_?"Sharing...":"Share Walkthrough"})})})})]}):(0,r.jsxs)("div",{className:"flex flex-col w-full min-h-screen bg-[#FBF5DA]",children:[(0,r.jsxs)(d(),{children:[(0,r.jsx)("title",{children:"Loading - tenantli"}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"}),(0,r.jsx)("meta",{name:"theme-color",content:"#FBF5DA"})]}),(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#1C2C40]"})})]})}},1479:function(){}},function(e){e.O(0,[1664,2888,9774,179],function(){return e(e.s=4885)}),_N_E=e.O()}]);